<cib epoch="140" num_updates="27" admin_epoch="0" validate-with="pacemaker-1.2" crm_feature_set="3.0.5" update-origin="node2" update-client="crmd" cib-last-written="Mon Sep 23 17:02:03 2013" have-quorum="0" dc-uuid="node2">
  <configuration>
    <crm_config>
      <cluster_property_set id="cib-bootstrap-options">
        <nvpair id="cib-bootstrap-options-dc-version" name="dc-version" value="1.1.6-9971ebba4494012a93c03b40a2c58ec0eb60f50c"/>
        <nvpair id="cib-bootstrap-options-cluster-infrastructure" name="cluster-infrastructure" value="cman"/>
        <nvpair id="cib-bootstrap-options-stonith-enabled" name="stonith-enabled" value="false"/>
        <nvpair id="cib-bootstrap-options-no-quorum-policy" name="no-quorum-policy" value="ignore"/>
        <nvpair id="cib-bootstrap-options-last-lrm-refresh" name="last-lrm-refresh" value="1379980923"/>
      </cluster_property_set>
    </crm_config>
    <nodes>
      <node id="node1" type="normal" uname="node1">
        <instance_attributes id="nodes-node1">
          <nvpair id="nodes-node1-standby" name="standby" value="off"/>
        </instance_attributes>
      </node>
      <node id="node2" type="normal" uname="node2">
        <instance_attributes id="nodes-node2">
          <nvpair id="nodes-node2-standby" name="standby" value="off"/>
        </instance_attributes>
      </node>
    </nodes>
    <resources>
      <master id="ms_drbd_iscsi.target">
        <meta_attributes id="ms_drbd_iscsi.target-meta_attributes">
          <nvpair id="ms_drbd_iscsi.target-meta_attributes-master-max" name="master-max" value="1"/>
          <nvpair id="ms_drbd_iscsi.target-meta_attributes-master-node-max" name="master-node-max" value="1"/>
          <nvpair id="ms_drbd_iscsi.target-meta_attributes-clone-max" name="clone-max" value="2"/>
          <nvpair id="ms_drbd_iscsi.target-meta_attributes-clone-node-max" name="clone-node-max" value="1"/>
          <nvpair id="ms_drbd_iscsi.target-meta_attributes-notify" name="notify" value="true"/>
        </meta_attributes>
        <primitive class="ocf" id="p_drbd_iscsi.target" provider="linbit" type="drbd">
          <instance_attributes id="p_drbd_iscsi.target-instance_attributes">
            <nvpair id="p_drbd_iscsi.target-instance_attributes-drbd_resource" name="drbd_resource" value="iscsi.target.0"/>
          </instance_attributes>
          <operations>
            <op id="p_drbd_iscsi.target-monitor-29s" interval="29s" name="monitor" role="Master"/>
            <op id="p_drbd_iscsi.target-monitor-31s" interval="31s" name="monitor" role="Slave"/>
          </operations>
        </primitive>
      </master>
      <group id="g_iscsi">
        <primitive class="ocf" id="p_target_iscsi" provider="heartbeat" type="iSCSITarget">
          <instance_attributes id="p_target_iscsi-instance_attributes">
            <nvpair id="p_target_iscsi-instance_attributes-iqn" name="iqn" value="iqn.2013-09.com.ziptrek:storage.target.0"/>
            <nvpair id="p_target_iscsi-instance_attributes-implementation" name="implementation" value="iet"/>
            <nvpair id="p_target_iscsi-instance_attributes-tid" name="tid" value="1"/>
          </instance_attributes>
          <operations>
            <op id="p_target_iscsi-monitor-10s" interval="10s" name="monitor"/>
          </operations>
        </primitive>
        <primitive class="ocf" id="p_lu_target_lun1" provider="heartbeat" type="iSCSILogicalUnit">
          <instance_attributes id="p_lu_target_lun1-instance_attributes">
            <nvpair id="p_lu_target_lun1-instance_attributes-target_iqn" name="target_iqn" value="iqn.2013-09.com.ziptrek:storage.target.0"/>
            <nvpair id="p_lu_target_lun1-instance_attributes-lun" name="lun" value="1"/>
            <nvpair id="p_lu_target_lun1-instance_attributes-path" name="path" value="/dev/drbd1"/>
            <nvpair id="p_lu_target_lun1-instance_attributes-implementation" name="implementation" value="iet"/>
          </instance_attributes>
          <operations>
            <op id="p_lu_target_lun1-monitor-10s" interval="10s" name="monitor"/>
          </operations>
        </primitive>
        <primitive class="ocf" id="p_ip_node1node2" provider="heartbeat" type="IPaddr">
          <instance_attributes id="p_ip_node1node2-instance_attributes">
            <nvpair id="p_ip_node1node2-instance_attributes-ip" name="ip" value="192.168.2.47"/>
          </instance_attributes>
          <operations>
            <op id="p_ip_node1node2-monitor-10s" interval="10s" name="monitor"/>
          </operations>
        </primitive>
      </group>
    </resources>
    <constraints>
      <rsc_order first="ms_drbd_iscsi.target" first-action="promote" id="o_drbd_before_iscsi.target" score="INFINITY" then="g_iscsi" then-action="start"/>
      <rsc_colocation id="c_iscsi.target_on_drbd" rsc="g_iscsi" score="INFINITY" with-rsc="ms_drbd_iscsi.target" with-rsc-role="Master"/>
      <rsc_location id="cli-prefer-g_iscsi" rsc="g_iscsi">
        <rule id="cli-prefer-rule-g_iscsi" score="INFINITY" boolean-op="and">
          <expression id="cli-prefer-expr-g_iscsi" attribute="#uname" operation="eq" value="node2" type="string"/>
        </rule>
      </rsc_location>
    </constraints>
  </configuration>
  <status>
    <node_state id="node2" uname="node2" ha="active" in_ccm="true" crmd="online" join="member" expected="member" crm-debug-origin="do_update_resource" shutdown="0">
      <lrm id="node2">
        <lrm_resources>
          <lrm_resource id="p_ip_node1node2" type="IPaddr" class="ocf" provider="heartbeat">
            <lrm_rsc_op id="p_ip_node1node2_last_0" operation_key="p_ip_node1node2_start_0" operation="start" crm-debug-origin="do_update_resource" crm_feature_set="3.0.5" transition-key="37:2:0:6dc84938-42fa-4714-accd-a8045bd473f5" transition-magic="0:0;37:2:0:6dc84938-42fa-4714-accd-a8045bd473f5" call-id="16" rc-code="0" op-status="0" interval="0" last-run="1380151015" last-rc-change="1380151015" exec-time="250" queue-time="0" op-digest="d743a796ef7248ed616ff4e3efbf45ca"/>
            <lrm_rsc_op id="p_ip_node1node2_monitor_10000" operation_key="p_ip_node1node2_monitor_10000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.5" transition-key="38:2:0:6dc84938-42fa-4714-accd-a8045bd473f5" transition-magic="0:0;38:2:0:6dc84938-42fa-4714-accd-a8045bd473f5" call-id="17" rc-code="0" op-status="0" interval="10000" last-rc-change="1380151015" exec-time="40" queue-time="0" op-digest="639dd4b72c210e7dd22bd07013de05a8"/>
          </lrm_resource>
          <lrm_resource id="p_target_iscsi" type="iSCSITarget" class="ocf" provider="heartbeat">
            <lrm_rsc_op id="p_target_iscsi_last_0" operation_key="p_target_iscsi_start_0" operation="start" crm-debug-origin="do_update_resource" crm_feature_set="3.0.5" transition-key="33:2:0:6dc84938-42fa-4714-accd-a8045bd473f5" transition-magic="0:0;33:2:0:6dc84938-42fa-4714-accd-a8045bd473f5" call-id="12" rc-code="0" op-status="0" interval="0" last-run="1380151014" last-rc-change="1380151014" exec-time="170" queue-time="0" op-digest="7aaa977624cc8a3ee4b43871ee421ffe"/>
            <lrm_rsc_op id="p_target_iscsi_monitor_10000" operation_key="p_target_iscsi_monitor_10000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.5" transition-key="34:2:0:6dc84938-42fa-4714-accd-a8045bd473f5" transition-magic="0:0;34:2:0:6dc84938-42fa-4714-accd-a8045bd473f5" call-id="13" rc-code="0" op-status="0" interval="10000" last-rc-change="1380151015" exec-time="140" queue-time="0" op-digest="5da221e1dee09691dd820a542ef3ca88"/>
          </lrm_resource>
          <lrm_resource id="p_lu_target_lun1" type="iSCSILogicalUnit" class="ocf" provider="heartbeat">
            <lrm_rsc_op id="p_lu_target_lun1_last_0" operation_key="p_lu_target_lun1_start_0" operation="start" crm-debug-origin="do_update_resource" crm_feature_set="3.0.5" transition-key="35:2:0:6dc84938-42fa-4714-accd-a8045bd473f5" transition-magic="0:0;35:2:0:6dc84938-42fa-4714-accd-a8045bd473f5" call-id="14" rc-code="0" op-status="0" interval="0" last-run="1380151015" last-rc-change="1380151015" exec-time="150" queue-time="0" op-digest="981793dae5bfa13298c6a3860acc02ad"/>
            <lrm_rsc_op id="p_lu_target_lun1_monitor_10000" operation_key="p_lu_target_lun1_monitor_10000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.5" transition-key="36:2:0:6dc84938-42fa-4714-accd-a8045bd473f5" transition-magic="0:0;36:2:0:6dc84938-42fa-4714-accd-a8045bd473f5" call-id="15" rc-code="0" op-status="0" interval="10000" last-rc-change="1380151015" exec-time="130" queue-time="0" op-digest="c01adce7c1768e8e2254eeebce155c08"/>
          </lrm_resource>
          <lrm_resource id="p_drbd_iscsi.target:0" type="drbd" class="ocf" provider="linbit">
            <lrm_rsc_op id="p_drbd_iscsi.target:0_last_0" operation_key="p_drbd_iscsi.target:0_promote_0" operation="promote" crm-debug-origin="do_update_resource" crm_feature_set="3.0.5" transition-key="7:1:0:6dc84938-42fa-4714-accd-a8045bd473f5" transition-magic="0:0;7:1:0:6dc84938-42fa-4714-accd-a8045bd473f5" call-id="9" rc-code="0" op-status="0" interval="0" last-run="1380151014" last-rc-change="1380151014" exec-time="110" queue-time="0" op-digest="59c06ea7c51db2c6fe06a1ab3c6267e1"/>
            <lrm_rsc_op id="p_drbd_iscsi.target:0_monitor_29000" operation_key="p_drbd_iscsi.target:0_monitor_29000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.5" transition-key="8:2:8:6dc84938-42fa-4714-accd-a8045bd473f5" transition-magic="0:8;8:2:8:6dc84938-42fa-4714-accd-a8045bd473f5" call-id="11" rc-code="8" op-status="0" interval="29000" last-rc-change="1380151014" exec-time="240" queue-time="0" op-digest="9d891c72fcee2fcdcbac8de1d4402247"/>
          </lrm_resource>
        </lrm_resources>
      </lrm>
      <transient_attributes id="node2">
        <instance_attributes id="status-node2">
          <nvpair id="status-node2-probe_complete" name="probe_complete" value="true"/>
          <nvpair id="status-node2-master-p_drbd_iscsi.target.0" name="master-p_drbd_iscsi.target:0" value="10000"/>
        </instance_attributes>
      </transient_attributes>
    </node_state>
    <node_state id="node1" uname="node1" ha="dead" in_ccm="false" crmd="offline" join="down" crm-debug-origin="do_state_transition"/>
  </status>
</cib>
